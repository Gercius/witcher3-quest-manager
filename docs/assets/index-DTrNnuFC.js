(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const r of t.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function c(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function o(e){if(e.ep)return;e.ep=!0;const t=c(e);fetch(e.href,t)}})();function y(){const n=document.querySelector(".menu-wrapper"),s=document.querySelector(".menu-button"),c=document.querySelectorAll(".menu-button img");if(!s||!n){console.error("menuButton or menuWrapper found!");return}s.addEventListener("click",o);function o(){c.forEach(e=>{e.classList.toggle("hidden")}),n.classList.toggle("menu-show")}}async function E(){const n="data/quests.json";try{const s=await fetch(n);if(!s.ok)throw new Error(`Response status: ${s.status}`);return await s.json()}catch(s){console.error(s.message)}}const S=E();async function k(){const n=document.querySelector("main table tbody");if(!n){console.error("Tbody not found!");return}const s=await S;for(let o=0;o<s.length;o++){const e=s[o],t=document.createElement("tr");t.setAttribute("data-id",o.toString()),t.classList.add("quest"),(e.extraDetails.length<2||!e.extraDetails)&&t.classList.add("last-quest-row");const r=document.createElement("td");r.textContent=e.location,r.rowSpan=e.extraDetails.length||1,t.append(r);const a=document.createElement("td");if(a.classList.add("quest-name"),!e.questInfo.orderMatters){const i=document.createElement("img");i.src="imgs/kekw.jpg",a.appendChild(i)}const l=document.createElement("a");l.classList.add("quest-link"),l.textContent=e.questInfo.name,l.setAttribute("href",e.questInfo.hyperlink),a.append(l),a.rowSpan=e.extraDetails.length||1,t.append(a);const d=document.createElement("td");d.classList.add("quest-completed");const u=document.createElement("input");u.type="checkbox",d.append(u),d.rowSpan=e.extraDetails.length||1,t.append(d);const m=c(e.extraDetails,!0);if(t.append(m),n.append(t),e.extraDetails.length>1)for(let i=1;i<e.extraDetails.length;i++){const g=i===e.extraDetails.length-1,p=document.createElement("tr");p.setAttribute("data-id",o.toString());const q=c(e.extraDetails,!1,i);g&&p.classList.add("last-quest-row"),p.append(q),n.append(p)}}function c(o,e=!1,t=0){var a,l,d;const r=document.createElement("td");if(r.classList.add("extra-detail"),(a=o[e?0:t])!=null&&a.hyperlink&&o[e?0:t].description){const u=document.createElement("a");u.classList.add("extra-detail-link"),u.textContent=o[e?0:t].description,u.setAttribute("href",o[e?0:t].hyperlink),r.append(u)}else if((l=o[e?0:t])!=null&&l.hyperlink&&!o[e?0:t].description){const u=document.createElement("a");u.classList.add("extra-detail-link"),u.textContent=o[e?0:t].hyperlink,u.setAttribute("href",o[e?0:t].hyperlink),r.append(u)}else r.textContent=(d=o[e?0:t])==null?void 0:d.description;return r}}const f={get:()=>{const n=document.querySelectorAll("tr.quest"),s=[];return n.forEach(c=>{const o=c.dataset.id;if(typeof o!="string"){console.error("id must be string!");return}let t=localStorage.getItem(o)==="true";s.push({id:o||"",isCompleted:t});const r=c.querySelector(".quest-completed input");r&&(r.checked=t)}),s},save:()=>{document.querySelectorAll("tr.quest").forEach(s=>{if(typeof s.dataset.id!="string"){console.error("id must be string!");return}const e=s.querySelector(".quest-completed input").checked,t=s.dataset.id;if(!t||typeof t!="string"){console.error("Quest storage key is of incorrect type or not found!");return}localStorage.setItem(t,e.toString())})}};function h(){const n=document.querySelector(".quest-count"),s=document.querySelector(".completed-percentage");if(!s||!n){console.error("completedHeaderEl or questCountEl not found!");return}const c=f.get(),o=c.length,e=c.filter(r=>r.isCompleted===!0).length,t=(e/o*100).toFixed(1);s.textContent=t,n.innerHTML=`${e}/${o}`}function b(){const n=document.querySelector(".hide-quests input");if(!n){console.error("hideQuestsBtn not found!");return}const s="hide-quests";let o=localStorage.getItem(s)==="true";n.checked=o,e(o),n.addEventListener("click",()=>{const t=n.checked;localStorage.setItem(s,`${t?"true":"false"}`),e(t)});function e(t){document.querySelectorAll("tbody .quest").forEach(a=>{const l=a.querySelector(".quest-completed input");if(!l){console.error("isCompletedEl not found!");return}const d=l.checked,u=a.dataset.id;document.querySelectorAll(`[data-id="${u}"]`).forEach(i=>{d&&i.classList.toggle("hidden-completed",t)})})}}function L(n){const s=document.querySelector(".hide-quests input");if(!s){console.error("hideQuestsBtn not found!");return}if(!s.checked)return;const c=n,o=n.parentElement.parentElement;if(!o){console.log("questEl not found!");return}const e=o.dataset.id,t=c.checked;document.querySelectorAll(`[data-id="${e}"]`).forEach(a=>{t&&a.classList.toggle("hidden-completed")})}function C(){const n=document.querySelector("table");if(!n){console.error("Table element not found!");return}h(),n.addEventListener("click",s=>{const c=s.target;if(!c){console.error("Click event not working properly");return}c.matches(".quest-completed input")&&(f.save(),h(),L(c))})}function w(){const n=document.querySelector(".quest-search input");if(!n){console.error("searchInput not found!");return}let s=[];n.addEventListener("focus",()=>{s=c()}),n.addEventListener("input",o=>{const t=o.target.value.toLowerCase();for(const r of s){const l=r[0].querySelector(".quest-name a").innerHTML.toLowerCase().includes(t);r.forEach(d=>{d.classList.toggle("hidden",!l)})}});function c(){const e=f.get().map(r=>r.id),t=[];for(const r of e)t.push(document.querySelectorAll(`[data-id="${r}"]`));return t}}function I(){const n=document.querySelector("main"),s=document.querySelector(".theme-switch input"),c="preferred-theme";if(!n||!s){console.error("Main or toggleThemeButton not found!");return}const o=localStorage.getItem(c),e=window.matchMedia("(prefers-color-scheme: dark)").matches;o?(o==="dark"?n.classList.add("dark-theme"):n.classList.remove("dark-theme"),s.checked=o==="dark"):(e&&n.classList.add("dark-theme"),s.checked=e),s.addEventListener("click",t);function t(){if(!n||!s){console.error("Body or toggleThemeButton not found!");return}s.checked?(n.classList.add("dark-theme"),localStorage.setItem(c,"dark")):(n.classList.remove("dark-theme"),localStorage.setItem(c,"light"))}}(async function(){y(),await k(),I(),C(),b(),w()})();(()=>{const n=document.querySelector(".export-quest-data");if(!n){console.error("Export button not found!");return}n.addEventListener("click",()=>{if(window.confirm("Export quest data?")){const o=c();s(o,"quest-data.json")}});function s(o,e="file.txt"){const t=URL.createObjectURL(o),r=document.createElement("a");r.href=t,r.download=e,document.body.appendChild(r),r.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),document.body.removeChild(r)}function c(){const o=document.querySelectorAll(".quest"),e=[];o.forEach(a=>{const l=a.dataset.id;let d=a.querySelector(".quest-name");const u=a.querySelector(".quest-completed input"),m={id:l||"",name:d!=null&&d.textContent?d.textContent:"",isCompleted:u?u.checked:!1};e.push(m)});const t=JSON.stringify(e,null,2);return new Blob([t],{type:"application/json"})}})();(()=>{const n=document.querySelector(".import-quest-data");if(!n){console.error("File input not found!");return}n.addEventListener("change",()=>{if(n.files&&n.files.length>0){const s=new FileReader;s.readAsText(n.files[0]),s.addEventListener("load",()=>{if(window.confirm("Import quest data?")){try{const c=s.result;if(typeof c!="string")throw new Error("Invalid file content");const o=JSON.parse(c),e=document.querySelectorAll("tbody tr.quest");o.forEach(t=>{for(const r of e){const a=r.dataset.id;let l=r.querySelector(".quest-completed input");if(!l){console.error("Checkbox not found!");return}t.id===a&&(l.checked=!!t.isCompleted)}})}catch{alert("Please import correct data")}f.save(),h()}else n.value=""})}})})();
